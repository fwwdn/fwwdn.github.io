<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>fwwdn&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="fwwdn's blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="fwwdn's blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="fwwdn's blog">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="fwwdn&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="/img/me.png" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">fwwdn</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/随笔">随笔</a></li>
				        
							<li><a href="/tags/相册">相册</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/fwwdn" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/u/1713855955/home?wvr=5" title="weibo">weibo</a>
					        
								<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/fwwdn" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/NoSQL/" style="font-size: 10px;">NoSQL</a> <a href="/tags/NoSQL-Redis/" style="font-size: 10px;">NoSQL Redis</a> <a href="/tags/Tools/" style="font-size: 20px;">Tools</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/后端技术/" style="font-size: 10px;">后端技术</a> <a href="/tags/收藏/" style="font-size: 15px;">收藏</a> <a href="/tags/架构/" style="font-size: 15px;">架构</a> <a href="/tags/电商/" style="font-size: 10px;">电商</a> <a href="/tags/随笔/" style="font-size: 10px;">随笔</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://dbanotes.net/">冯大辉</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">随身云后端开发，关注的技术：Linux、java、memcached、redis,、mysql、 solr。</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">fwwdn</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/me.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">fwwdn</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/随笔">随笔</a></li>
		        
					<li><a href="/tags/相册">相册</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/fwwdn" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/u/1713855955/home?wvr=5" title="weibo">weibo</a>
			        
						<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/fwwdn" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-happy-work" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/07/09/happy-work/" class="article-date">
  	<time datetime="2015-07-09T14:38:56.000Z" itemprop="datePublished">2015-07-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/09/happy-work/">谈谈程序员如何快乐的工作</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>经常听到很多程序员抱怨自己工作任务重，业务忙，没时间研究自己喜欢的技术。他们总认为这是产品或者运营提的需求太多且不合理。总觉得自己的工作没有创造力，每天都在重复的增、删、改、查。</p>
<p>确实，有时候我们会碰到一些SB产品，他们不懂技术、不懂业务，经常前一分钟提的需求，后一分钟就改了。</p>
<p>大部分基层程序员的工作也确实是增删改，没有时髦的前沿技术（生产环境不敢上），没有高大上的技术词汇，大部分的时间也都是在框架中套代码。</p>
<p>但仔细想想，当我们</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-daily-sites" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/07/07/daily-sites/" class="article-date">
  	<time datetime="2015-07-07T14:24:29.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/daily-sites/">日常翻看技术网站</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>总结下平时工作经常翻看的技术网站。</p>
<h2 id="内容生产者">内容生产者</h2><p><a href="http://www.infoq.com/cn/" target="_blank" rel="external">InfoQ</a> </p>
<p><a href="http://ifeve.com/" target="_blank" rel="external">并发编程网</a></p>
<p><a href="http://highscalability.com/" target="_blank" rel="external">highscalability</a></p>
<p><a href="http://jm-blog.aliapp.com/" target="_blank" rel="external">阿里中间件团队博客</a></p>
<p><a href="http://tech.meituan.com/" target="_blank" rel="external">美团技术博客</a></p>
<h2 id="每日文摘">每日文摘</h2><p><a href="http://www.toutiao.io/" target="_blank" rel="external">开发者头条</a></p>
<p><a href="http://geek.csdn.net/" target="_blank" rel="external">CSDN的极客头条</a></p>
<p><a href="http://weekly.manong.io/issues/" target="_blank" rel="external">码农周刊</a>及其<a href="https://github.com/nemoTyrant/manong" target="_blank" rel="external">按技术分类的总索引</a></p>
<p><a href="http://www.tuicool.com/mags" target="_blank" rel="external">编程狂人周刊</a></p>
<p><a href="http://www.udpwork.com/" target="_blank" rel="external">IT牛人博客聚合</a></p>
<p><a href="https://news.ycombinator.com/" target="_blank" rel="external">Hacker News</a></p>
<h2 id="独立博客">独立博客</h2><p><a href="http://coolshell.cn/" target="_blank" rel="external">左耳朵耗子的酷壳</a></p>
<p><a href="http://timyang.net/" target="_blank" rel="external">Timyang</a></p>
<p><a href="http://colobu.com/" target="_blank" rel="external">鸟窝</a></p>
<p><a href="http://blog.2baxb.me/" target="_blank" rel="external">Axb的自我修养</a></p>
<p><a href="http://www.ruanyifeng.com/blog/" target="_blank" rel="external">阮一峰的网络日志</a></p>
<p><a href="http://www.cnblogs.com/zhengyun_ustc/" target="_blank" rel="external">旁观者-郑昀</a></p>
<p><a href="http://antirez.com/latest/0" target="_blank" rel="external">Redis作者antirez的weblog</a></p>
<p>大家也可在评论中留下你的推荐。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/收藏/">收藏</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-useful-linux-commands" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/07/06/useful-linux-commands/" class="article-date">
  	<time datetime="2015-07-06T14:26:15.000Z" itemprop="datePublished">2015-07-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/06/useful-linux-commands/">收藏的一些常用Linux命令</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li><p>抓取某个进程:ps -eaf | grep xxx ，一般用作ps -aux | grep xxx</p>
</li>
<li><p>ctrl+r:搜索某个以前输入过的命令 或者!command</p>
</li>
<li><p>sudo !!执行最近输入的一次命令</p>
</li>
<li><p>输入错误命令全部取消，重新输入：ctrl+c</p>
</li>
<li><p>set、env、export的区别：<br>set是shell变量，env是环境变量，export是一个将shell变量导入到env变量集合的工具。<br>打开一个shell后，操作系统会分配一个记忆块给shell使用，此内存内的变量可让子进程取用；若在父进程利用export功能，可以让自定义变量的内容写到上述的记忆块中（环境变量）；当加载另一个shell时（启动子shell，离开父shell，可通过echo $$查看该shell的PID），子shell可以将父shell的环境变量所在的记忆块导入自己的环境变量块当中。</p>
</li>
<li><p>tar是打包命令，不压缩，但一般使用中有z压缩成gzip和j压缩成bzip2.</p>
<ul>
<li>tar -jtv -f a.bzip2 查看包内文件</li>
<li>tar -jcv -f DES 新建压缩包</li>
<li>ar -jxv -f DES 解压包</li>
</ul>
</li>
<li><p>scp命令是linux主机间的文件传输命令。格式为</p>
<ul>
<li>scp local_file user@remote_ip:$DIR(本地到远端)<ul>
<li>scp user@remote_ip:file $DIR(远端到本地)</li>
</ul>
</li>
</ul>
</li>
<li><p>linux的rpm机制 在linux下，几乎所有的软件都是通过rpm方式来进行安装、卸载、管理的。RPM的全称为redhat package manager，是由redhat公司提出的，用于管理linux下软件的软件。rpm一般分为5个模式：安装、卸载、升级、查询、验证。</p>
<ul>
<li>rpm安装：rpm -ivh example.rpm //安装 example.rpm 包并在安装过程中显示正在安装的文件信息及安装进度；</li>
<li>rpm卸载：rpm -e tomcat4 //卸载 tomcat4 软件包(一般先使用rpm查询安装包是否存在、安装目录什么的)</li>
<li>rpm升级：rpm -Uvh example.rpm //升级 example.rpm 软件包</li>
<li>rpm查询：rpm -qa | grep tomcat4 //查看 tomcat4 是否被安装；rpm -qpl packagename //查看rpm包中的内容</li>
<li>rpm验证：rpm -Vf /etc/tomcat4/tomcat4.conf //验证rpm包的修改信息等</li>
</ul>
</li>
<li><p>在一个文件夹中需要找到某个变量的定义，可以使用这个命令（其实是脚本）:<br>for file in ls;do echo $file;grep ‘CQueryFeed’ $file;done</p>
</li>
<li><p>在学了find,grep之后，功力暴涨：find ./* -exec grep -Hn ‘keyword’ {} \;</p>
</li>
<li><p>安装源码包后，无法找到动态库：这个首先需要了解动态库和静态库的区别，然后需要了解/etc/ld.so.conf，默认情况下，编译器寻找动态库只会到/lib和/usr/lib下寻找，如果我们我们没有使用—prefix指定安装目录，那么会安装到/usr/local下，这时我们可以把/usr/local/lib加入到/etc/ld.so.conf中，然后用/sbin/ldconfig命令将新安装的库缓存到/etc/ld.so.cache中，这样编译器就能找到新安装的库了。第二种解决方法就是改变PKG_CONFIG_PATH，这个ls /usr/lib/pkgconfig看到的*.pc就会明白这个变量的作用了。</p>
</li>
<li><p>在Ubuntu中创建新用户，通常会用到两个命令：useradd和adduser。虽然作用一样，但用法却不尽相同：<br>使用useradd时，如果后面不添加任何参数选项，例如：#sudo useradd test创建出来的用户将是默认“三无”用户：一无Home Directory，二无密码，三无系统Shell。<br>使用adduser时，创建用户的过程更像是一种人机对话，系统会提示你输入各种信息，然后会根据这些信息帮你创建新用户。</p>
</li>
<li><p>mbr是硬盘的一个引导区，而grub是一个引导程序！在mbr中有一段空间需要编写引导程序！grub只是引导程序的一种！如果grub够小的话，直接写在mbr中，就可以引导操作系统了！如果grub太大，在只能写一部分在mbr了！如果装windows则硬盘中的grub程序就不能运行了！不是不行，而是微软不愿兼容其它操作系统程序！<br>ubuntu下的鼠标有时候设置起来不是很管用，这时候我们可以通过xset m a b来设置，a代表加速多少倍，b代表移动多少像素。这个命令的意思就是在移动b个像素之后鼠标加速a倍。如果你的鼠标灵敏度太高，就可以把b调到很大，这样鼠标肯定就不能加速，鼠标速度就能慢下来了。<br>在命令提示符中输入命令，难免会输错。有几个命令会很常用：</p>
<ul>
<li>ctrl + c :直接停止当前命令行编辑，转到下一行</li>
<li>ctrl + u:删除本行的命令</li>
<li>ctrl + a:到命令头</li>
<li>ctrl + e:到命令尾</li>
<li>ctrl+w:删除当前字段</li>
</ul>
</li>
<li><p>在查看某个服务的log时，经常使用tail -f命令循环查看log的实时信息，同样，还有一个watch -d ls -l命令，默认2秒检测一下ls -l的情况，如果有变动就会高亮显示。另外，在查看进程时，ps是查看某个时间点，而top如tail -f和watch -d一样，也可以动态查看。<br>如果我们需要知道某些服务的进程号时，一般会使用ps aux | grep ssh这样的命令，然后再去看看各个进程的PID，其实有pgrep ssh这个命令，直接查找所有ssh的进程ID。</p>
</li>
<li><p>上传文件只需在shell终端仿真器中输入命令“rz”，即可从弹出的对话框中选择本地磁盘上的文件，利用Zmodem上传到服务器。下载文件只需在shell终端仿真器中输入命令“sz 文件名”，即可利用Zmodem将文件下载到“路径\SecureCRT-5.1.3\download\”目录下。通过“File Transfer”可以修改上传和下载的默认路径。</p>
</li>
<li><p>cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c查看CPU；free -g查看内存<br>当一个文件夹内log信息太多时，使用rm -f .log会显示augument list too long，这时可以使用find -name ‘.log’ | xargs rm -rf应该就可以了，或者写一个for的shell脚本也可以。</p>
</li>
<li><p>vim匹配汉字[^\x00-\x7f]+，然后如果替换3个字段中间那个，其他2个保持不变，可使用:1,$s(…)X(…)/\1Y\2/g即可。</p>
</li>
<li><p>awk -F “:” ‘/something_to_sum/ {sum += $5}; END {print sum}’ /data1/log/a.log，统计在a.log以：分隔的第五个字段的总和。cat a.log | grep ‘hello’ | wc -l 统计a.log中hello字段出现的总行数。当然，在vim中也可以统计，命令是”:%s/hello//gn”然后下方会提示有多少个match（只统计hello出现次数，与在不在同一行无关。所以统计行数时候有可能2个hello处在同一行，这样结果就不对了）【复制的时候看看双引号是不是被搞成中文了。。】</p>
</li>
<li><p>用vim操作后，当需要保存文件时我常用的是:wq命令，看到同事有用:x的。今天查了一下区别：<br>:wq 强制性写入文件并退出。即使文件没有被修改也强制写入，并更新文件的修改时间。<br>:x 写入文件并退出。仅当文件被修改时才写入，并更新文件修改时间，否则不会更新文件修改时间。 区别不大，但是当用make之类根据文件修改时间进行操作的工具时就有了影响。这点考虑到就可以了。<br>有时候用vim会遇到权限问题，比如一个root的文件，你用一个普通用户编辑了半天，等保存时候猛然发现，你没有权限。。。这是多么蛋疼的情景啊。不过当你试过这个命令就笑了“:w !sudo tee %”，解释一下：把当前编辑的文件的内容当做标准输入输入到命令sudo tee 文件名里去也就是sudo保存为当前文件名（%代表当前文件名）</p>
</li>
<li><p>在java中一般使用jdbc.properties配置mysql数据库。从中可以得到4个信息：name,pwd,url,port。name/pwd/port都直接标出来了，url就是mysql://:3746中间的部分。然后命令行登陆为&gt; mysql -uname -ppwd -hurl -Pport。</p>
</li>
<li><p>对数据库中某个字段（a）的所有记录中的另一个字段求和（b）：select SUM(b) from tablename where (Id=’a’) and (createTime like ‘20130926%’); 其中还用到了like，如果date不是date类型的，而是varchar的，就可以使用like，其中%代表mysql的通配符，然后你懂的。</p>
</li>
<li><p>发现/usr的空间全满了，可以使用du -sh * 查看当前目录下某个文件夹的大小。我使用的ll -h，原来以为是列出当前目录下面的所有文件/目录的总大小，其实对文件来说，是列出文件的大小（以人类易读的方式，如2k,3M,5G）,但是对于目录，目录保存的仅仅是下面文件的inode占用空间。（一般一个目录带下为4K），而如<br>果想要知道目录下所有文件占用的总空间，就得使用du（相当于统计的命令）</p>
</li>
<li><p>统计最常用的top ten命令：<br>history | awk ‘{CMD[$2]++;count++;} END { for(a in CMD) {print CMD[a] “ “ CMD[a]/count*100 “% “ a}}’ \<br>pipe&gt; | grep -v “./“ | column -c3 -s “ “ -t | sort -nr | nl | head -n10</p>
</li>
<li><p>linux查看设置的语言：/etc/sysconfig/i18n下。</p>
</li>
<li><p>有时候需要把一个文件排序，但是名字可能是固定的不想修改，你使用&gt;定向（sort 1 &gt; 1会把文件清空），而sort -o选项可以把结果写到原文件。比如sort -n 1 -o 1<br>使用cat合并文件，如cat 1.txt 2.txt 3.txt &gt; 4.txt；如果1/2/3.txt中存在多个空行，最终保存到4.txt时，连续的空行会被替换为1行。如果我们希望去掉空行，可以使用如下：cat -s 1.txt 2.txt 3.txt | sed ‘/^[[:space:]]*$/d’ &gt; 4.txt</p>
</li>
<li><p>vim的virtual模式分为3种：</p>
<ul>
<li>用v命令进入的字符可视化模式（Characterwise visual mode)。文本选择是以字符为单位的。</li>
<li>用V命令进入的行可视化模式（Linewise visual mode)。文本选择是以行为单位的。</li>
<li>用ctrl-V进入的块可视化模式（Blockwise visual mode）。可以选择一个矩形内的文本。（注意：    在Windows中，ctrl-V可能已经被影射为粘贴操作，可以使用ctrl-Q进入块可视化模式。）</li>
</ul>
</li>
<li><p>在使用diff命令的时候有3种显示，但是如果我们仅仅需要查看2个文件所有不同的记录，去掉diff加上的123a124或者&gt;或者&lt;,可以先diff a b &gt; difflog，然后使用grep+sed：cat difflog | grep -v ‘^[0-9]’ | sed -e ‘s/[^ ]* //‘ &gt; difflog2</p>
</li>
<li><p>管道是实现“将前面的标准输出作为后面的标准输入”xargs是实现“将标准输入作为命令的参数”</p>
</li>
<li><p>我们写完shell脚本一般会使用三种方式来执行</p>
<ul>
<li>source 1.sh：当前shell执行</li>
<li>sh 1.sh：子shell执行</li>
<li>./1.sh：子shell执行 很明显，子shell执行后对父shell没有任何影响，就好像局部变量。比如你1.sh起作用的是cd /data0/niushuai，那么你用后两种执行后，还是在当前目录（因为子shell进入/data0/niushuai后完成任务退出后，不会给父shell任何影响）；如果想对当前shell影响，就必须使用source。这就是配置.bashrc后需要source的原因。</li>
</ul>
</li>
<li><p>查询数据库某个表的大小（字节为单位）<br>use information_schema;<br>select TABLE_NAME,DATA_LENGTH+INDEX_LENGTH,TABLE_ROWS FROM TABLES WHERE TABLE_SCHEMA=’数据库名’ AND TABLE_NAME=’表名’;</p>
</li>
<li><p>mysql通过root新建数据库后，必须给某一用户通过grant授权后，用户才能正常使用。</p>
</li>
<li><p>vim将匹配的行全部删除:g/^2013#/d，删除所有以2013#开头的行。:g/^#/d删除空行。</p>
</li>
<li><p>获取本机某块网卡IP地址的命令：ifconfig eth0 | grep ‘inet addr’ | sed ‘s/^.addr://‘ | sed ‘s/ B.$//‘ 但是当一台机器有多个网卡且只有一个工作的时候，可以使用这个命令来获得当前机器提供网络服务的IP地址：grep $(hostname) /etc/hosts| awk ‘{print $1}’ 然后又碰到了逆天一样简单的hostname -i</p>
</li>
<li><p>有时候查看log日志时候，想抓取随机几行。但是log太大的时候，打开都不容易。我们可以使用sed -n ‘20,60p’ log &gt; temp.log。其中-n是安静模式（不在stdout输出）</p>
</li>
<li><p>监控某台服务器的cpu load信息（设置5s）：top -b -d 5 | grep —line-buffered ‘load’ &gt; cpuload &amp;</p>
</li>
<li><p>查看服务器CPU数目： cat /proc/cpuinfo | grep -c ‘model name’</p>
</li>
<li><p>查看当前内存使用情况可以使用top或者free来查看。</p>
</li>
<li><p>查看cpu使用情况：sar -u 5 720 &gt; cpu.out &amp;</p>
</li>
<li><p>查看cpu是几核的，详细信息： cat /proc/cpuinfo | grep ‘model name’</p>
</li>
<li><p>最新到位了新机器，修改了/etc/profile,root后用non login登陆的话，source /etc/profile发现只在当前shell生效，退出登陆还是不行。然后问了一下运维，才知道这个必须完全切换到root才能全局生效。由之前的sudo su切换变为login的sudo su -然后再source就可以了。</p>
</li>
</ul>
<p>——-   不断更新。。。。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-configure-many-git-account" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/07/01/configure-many-git-account/" class="article-date">
  	<time datetime="2015-07-01T14:30:45.000Z" itemprop="datePublished">2015-07-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/01/configure-many-git-account/">动态配置多个Git账号</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言">前言</h2><p>因为公司用gitbucket搭建了自己的代码库，要求使用公司的邮箱作为账号。而我自己又有一些开源代码放在github上，所以必须配置多个git账号，下面总结下我的配置过程：</p>
<h3 id="SSH配置">SSH配置</h3><p>使用ssh-keygen分别生成gitbucket和 github的密钥：</p>
<pre><code><span class="keyword">cd</span> ~/.ssh/
ssh-keygen -C <span class="string">"gitbucket email"</span> -t rsa 
Enter <span class="keyword">file</span> <span class="keyword">in</span> <span class="keyword">which</span> to <span class="keyword">save</span> the key (/Users/.ssh/id_rsa): id_rsa_gitbucket

ssh-keygen -C <span class="string">"github email"</span> -t rsa 
Enter <span class="keyword">file</span> <span class="keyword">in</span> <span class="keyword">which</span> to <span class="keyword">save</span> the key (/Users/.ssh/id_rsa): id_rsa_github
</code></pre><p>上传公钥到gitbucket和 Github服务器。</p>
<p>在~/.ssh目录下创建config文件，进行相应配置：</p>
<pre><code><span class="comment">#gitbucket</span>
Host gitbucket
HostName your_gitbucket_host
<span class="built_in">User</span> your_email
IdentityFile ~/.ssh/id_rsa_gitbucket

<span class="comment">#github</span>
Host github
HostName github.com
<span class="built_in">User</span> your_email
IdentityFile ~/.ssh/id_rsa_github
</code></pre><h3 id="检出服务端项目代码">检出服务端项目代码</h3><p>这里需要注意，使用.ssh目录下的host代替真实的hostname，这样才能让git识别出来,如：</p>
<pre><code>git clone git<span class="variable">@github</span><span class="symbol">:fwwdn/sensitive-words</span>.git
</code></pre><p>这里使用github代替@github.com</p>
<h3 id="解决commit后不能正常显示头像信息问题">解决commit后不能正常显示头像信息问题</h3><p>按上面的方法配置后，在你执行git commit -m “XXX”命令时会有如下提示：</p>
<pre><code>Your name <span class="keyword">and</span> email address were configured automatically based
<span class="literal">on</span> your username <span class="keyword">and</span> hostname. Please check <span class="literal">that</span> they are accurate.
ou can suppress <span class="keyword">this</span> message <span class="keyword">by</span> setting them <span class="attribute">explicitly</span>:

git config --<span class="built_in">global</span> user.name <span class="string">"Your Name"</span>
git config --<span class="built_in">global</span> user.email you<span class="property">@example</span>.com

After doing <span class="keyword">this</span>, you may fix the identity used <span class="keyword">for</span> <span class="keyword">this</span> commit <span class="attribute">with</span>:

git commit --amend --reset-author
</code></pre><p>当然，这并不会影响你push代码，但因为你的user name和你的user email配置有误，所以你的头像将不能在提交日志中正常显示。解决的办法如下：</p>
<h4 id="1、最笨的办法：">1、最笨的办法：</h4><p>取消git全局设置，很多同学照着网上的教程，都会对git进行全局设置，例如：</p>
<pre><code>git config --global user<span class="class">.name</span> <span class="string">"username"</span>
git config --global user<span class="class">.email</span>  <span class="string">"email"</span>
</code></pre><p>因为我们要配置多个账号，所以我们首先需要取消git的全局设置</p>
<pre><code><span class="comment">git</span> <span class="comment">config</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">global</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">unset</span> <span class="comment">user</span><span class="string">.</span><span class="comment">name</span>
<span class="comment">git</span> <span class="comment">config</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">global</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">unset</span> <span class="comment">user</span><span class="string">.</span><span class="comment">email</span>
</code></pre><p>针对每个项目，单独设置用户名和邮箱</p>
<p>设置方法如下：</p>
<pre><code>cd gitbucket/project
git config user<span class="class">.name</span> <span class="string">"gitbucket_username"</span>
git config user<span class="class">.email</span> <span class="string">"gitbucket_email"</span>

cd github/project
git config user<span class="class">.name</span> <span class="string">"github_username"</span>
git config user<span class="class">.email</span> <span class="string">"github_email"</span>
</code></pre><h4 id="2、半自动化方法：">2、半自动化方法：</h4><pre><code><span class="keyword">cd</span> ~
<span class="built_in">mkdir</span> .git-scripts
<span class="keyword">vim</span> ~/.git-scripts/account-config.<span class="keyword">sh</span>
</code></pre><p>shell脚本内容如下：</p>
<pre><code><span class="shebang">#!/bin/bash
</span>
remote=`git remote -v | awk <span class="string">'/\(push\)$/ {print $2}'</span>`

email=<span class="string">"gitbucket_email"</span>
name=<span class="string">"gitbucket_name"</span>

<span class="keyword">if</span> [[ <span class="variable">$remote</span> == *github* ]]; <span class="keyword">then</span>
    email=<span class="string">"github_email"</span>
    name=<span class="string">"github_name"</span>
<span class="keyword">fi</span>

<span class="built_in">echo</span> <span class="string">"Configuring user.email as <span class="variable">$email</span>"</span>
<span class="built_in">echo</span> <span class="string">"Configuring user.name as <span class="variable">$name</span>"</span>

git config user.email <span class="variable">$email</span>
git config user.name <span class="variable">$name</span>
</code></pre><p> 然后只需在每次git clone 项目之后，执行<strong>git account-config</strong> ，即可一步配置git account信息 。</p>
<p>至此，我们就可以使用多个git账号愉快的玩耍了。:)</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tools/">Tools</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-install-and-config-hexo-on-mac" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/06/30/install-and-config-hexo-on-mac/" class="article-date">
  	<time datetime="2015-06-30T15:34:17.000Z" itemprop="datePublished">2015-06-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Mac下hexo安装配置">Mac下hexo安装配置</h1><p>如果国内安装失败，请使用下面命令：</p>
<p>localhost:blog fww$ npm install -g hexo-cli —no-optional<br>^C<br>localhost:blog fww$ ls -l<br>total 0<br>drwxr-xr-x@ 11 fww  staff  374  6 30 23:10 hexo<br>localhost:blog fww$ npm install -g hexo-cli —registry=<a href="http://r.cnpmjs.org" target="_blank" rel="external">http://r.cnpmjs.org</a></p>
<p>hexo init</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-some-tips-for-using-redis" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/06/25/some-tips-for-using-redis/" class="article-date">
  	<time datetime="2015-06-25T13:58:04.000Z" itemprop="datePublished">2015-06-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/25/some-tips-for-using-redis/">Redis使用过程中需要注意的几个问题</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="缓存过期策略">缓存过期策略</h2><p>Redis在启动时会把数据加载到内存中，达到最大内存后，Redis会先尝试清除已到期或即将到期的Key，当此方法处理后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。</p>
<h2 id="是否需要redis的持久化能力？">是否需要redis的持久化能力？</h2><p>redis持久化的是数据集的当前快照，于是当你用它来做存储，而不是缓存时，就会很纠结。<br>当数据集很大的时候，比如64G内存，数据集30G，你愿意dump快照或者aof收缩吗？如果这样做，问题就来了，redis的dump是fork一个进程，利用操作系统内存管理的copy-on-write来得到当前内存快照，但如果数据的更新比较频繁，30G内存dump到磁盘的速度又不快，就会导致在dump的时候需要大量的内存来做写时copy，需要的新内存加上原有的30G内存，可能导致操作系统swap，同时因为copy-on-write，主线程在处理请求时也会变慢，redis的整体性能急速下降。所以大数据集把redis当做cache，只有当数据集很小的时候，才用它来做持久存储。</p>
<h2 id="内存碎片">内存碎片</h2><p>因为redis的malloc方式，导致一个潜在问题，就是当有很多small object放进去，又被频繁的free后，导致了大量的内存碎片，到一定临界点后，你会发现插入新数据的时候redis的性能急剧下降，原因在malloc函数上要花很长时间。</p>
<h2 id="使用场景">使用场景</h2><p>Redis的数据全部放在内存带来了高速的性能，但是也带来一些不合理之处。比如一个网站有1亿注册用户，如果这些资料要用Redis来存储，内存的容量必须能够容纳这1亿用户。但是业务实际情况是1亿用户只有1000万活跃用户，1周来访问过1次的也只有1500万用户，因此全部1亿用户的数据都放在内存有不合理之处，RAM需要为冷数据买单。</p>
<p>Redis最首要的实用场景：少量数据存储，高速读写需求。此类应用过程数据全部in-momery 的格式来提供高速读写，同时提供数据持久化的功能。</p>
<h2 id="一些经验教训：">一些经验教训：</h2><ol>
<li>使用 Redis 之前，做好容量规划，对数据的使用方式做好规划；</li>
<li>使用 Redis 的过程中，经常关注内存使用，做好监控报警；</li>
<li>谨慎选择持久化方案，对可能造成的高延迟要有心理准备；</li>
<li>小心Redis的内存碎片。</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NoSQL-Redis/">NoSQL Redis</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-data-structures-and-algorithms" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/06/24/data-structures-and-algorithms/" class="article-date">
  	<time datetime="2015-06-24T14:41:04.000Z" itemprop="datePublished">2015-06-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/24/data-structures-and-algorithms/">Data Structures And Algorithms</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="常见数据结构">常见数据结构</h2><ul>
<li>线性：数组，链表，队列，堆栈，块状数组（数组+链表），hash表，双端队列，位图（bitmap）</li>
<li>树：堆（大顶堆、小顶堆），trie树（字母树or字典树），后缀树，后缀树组，二叉排序/查找树，B+/B-，AVL树，Treap，红黑树，splay树，线段树，树状数组</li>
<li>图：图</li>
<li>其它：并查集</li>
</ul>
<h2 id="常见算法">常见算法</h2><ul>
<li>基本思想：枚举，递归，分治，模拟，贪心，动态规划，剪枝，回溯</li>
<li>图算法：深度优先遍历与广度优先遍历， 最短路径，最小生成树，拓扑排序</li>
<li>字符串算法：字符串查找，hash算法，KMP算法</li>
<li>排序算法：冒泡，插入，选择，快排，归并排序，堆排序，桶排序</li>
<li>动态规划：背包问题，最长公共子序列，最优二分检索树</li>
<li>数论问题：素数问题，整数问题，进制转换，同余模运算，</li>
<li>排列组合：排列和组合算法</li>
<li>其它：LCA与RMQ问题</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-monolithic-vs-microservice" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/06/23/monolithic-vs-microservice/" class="article-date">
  	<time datetime="2015-06-23T13:49:47.000Z" itemprop="datePublished">2015-06-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/23/monolithic-vs-microservice/">monolithic vs microservice</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>微服务（ Microservice ）是最近几年出现在架构领域的新的术语，无数的人根据自己的理解去解读微服务，一时间它成了秒杀单体应用（Monolithic ）、解决任何问题的灵丹妙药。</p>
<p>微服务真的是终极解决方案？单体应用真的没必要？什么时候适合单体应用？什么时候需要拆分服务？一个大的分布式系统如何从简单的单体应用成长为复杂的分布式微服务？本文将尝试回答这些问题。</p>
<p><img src="http://img2001.static.suishenyun.net/25ece6711a70a7938cb1105810f59bd3/047f460133c6d0f9184d9ebc684867a0.png!w480.jpg" alt=""></p>
<p>用 1 个程序实现所有的功能，这是一个单体（Monolithic ）应用。运行程序，所有的功能都属于同一个进程，它们之间的调用属于进程内通信。这就保证功能模块之间的同步通信，调用速度快。单体应用可能存在的问题包括：<br>一个进程集成了所有的功能，意味着它需要更多的系统资源。是否存在能够提供这些资源的主机？用户是否能够或者愿意负担这样的主机？<br>修改或者升级任何功能模块，必须先停止运行整个应用，导致应用暂时不可用。</p>
<p>把所有的功能划分为 n 个部分，分别用 1 个程序实现，这就是一个多体应用。多体应用既可以部署在单机上，也可以部署在多机上。</p>
<p>分布式应用的不同进程需要相互配合和协调，才能够完成指定的任务。这就要求在承认异步的前提下，提供可靠的故障检测机制、可靠的点对点通信和群组通信、可靠的数据一致性（核心点之一是定义逻辑顺序）等。这正是分布式系统研究的核心内容。</p>
<p>再看微服务（ Microservice ）的概念。首先，「微」意味着要拆分所有的功能，且分得相对较小，再实现为对应的程序；其次，「服务」意味着这个程序有多个（种）消费者，这些消费者的编程语言、框架和支撑系统不尽相同。这就要求提供标准化的命名和发现机制、访问协议和交换数据格式。像现在流行的一种实现方式，是以 RESTful 风格 API 形式提供微服务，用 DNS 作为服务命名和发现机制， HTTP(S) 作为访问协议， JSON 作为数据格式。</p>
<p>对于一个分布式系统，在设计架构时，我们需要考虑下列问题：</p>
<ul>
<li><p>要不要拆分功能，拆分的粒度多大？</p>
</li>
<li><p>拆分后的不同组件，是部署在单机上还是多机上？</p>
</li>
<li><p>其中的一些组件，需要为多个（种）消费者提供服务吗？</p>
</li>
<li><p>各个服务间如何通信？</p>
</li>
<li><p>一个服务挂掉如何保证其他依赖此服务的服务的可用性？</p>
</li>
<li><p>分布式事务如何保证？</p>
</li>
</ul>
<p>对于初创公司，要以实现业务功能为先，此时，由于人力、财力都较少，所以适合单体应用，快速开发、部署。</p>
<p>后面随着业务的发展，人员的增加，开发、运维人员的完整，系统也逐渐发展变大，一些公共的功能可以拆分出去作为独立的服务，交由专门团队维护，这样做，一是提高复用，避免重复造轮子；二是，减少依赖；</p>
<p>再然后，业务继续发展，人员继续增加，此时我们的系统已经相当庞大了。需要将一些核心功能拆分，将大系统拆分为多个微服务，分开部署。提高开发效率。但这样不可避免的增加了运维的成本；</p>
<p>基本上，大的互联网系统都是按照上面的路子演化而来。君不见，淘宝最初也只是一个php写的bbs。</p>
<p>一个大型的分布式系统，最核心是做好下面四点：</p>
<ul>
<li><p>大规模分布式缓存系统。单靠数据库当然不可能，几台redis、mongo啥的也不够，需要上百台内存存储。并做好可靠的故障转移，冷然数据处理。</p>
</li>
<li><p>高效可靠的队列系统：亿级pv意味随时有大量数据从用户端产生，并且有一套复杂的后端系统，任意数据提交都需要考虑对这些分布式存储、服务的影响。高效可靠的队列服务必不可少。</p>
</li>
<li><p>细粒度的数据服务系统：用户数据读写、统一id生成、图片视频的写入读取、核心业务对象(例如电商商品订单)的读写都需要独立服务化与子系统化，并能与其它系统实现高效方便的rpc通讯。</p>
</li>
<li><p>强大的线上监控、部署系统。能应对突发故障、流量。</p>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/架构/">架构</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-100-cpu-usage-issue" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/06/20/100-cpu-usage-issue/" class="article-date">
  	<time datetime="2015-06-20T15:40:09.000Z" itemprop="datePublished">2015-06-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/20/100-cpu-usage-issue/">一次线上环境CPU过高问题解决过程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天早晨，发现海外版的一个线上服务响应很慢，接口要刷新半天。ssh上去看了内存、磁盘都正常;用top查看cpu时发现Java进程cpu占用超过100%。tail -f 看了日志，发现几个error和warn但都感觉和cpu占用高关系不大。<br>所以初步怀疑是某些线程有问题：</p>
<ul>
<li>使用top查找出最耗cpu的进程号（PID）<br><img src="http://img2001.static.suishenyun.net/25ece6711a70a7938cb1105810f59bd3/acb9edd3e1ad94ea83e38a8ff956653e.jpg!w480.jpg" alt=""></li>
</ul>
<p>发现最占CPU的进程是 1414</p>
<ul>
<li>使用jstack dump对应PID的堆栈信息保存备查</li>
</ul>
<p>jstack是JDK内置的性能调优工具，对于分析线程堆栈非常有用。直接  jstack 1414 &gt; jstack.out</p>
<p><img src="http://img2001.static.suishenyun.net/25ece6711a70a7938cb1105810f59bd3/bcf29f1958e24af7e7bbe2172a5b658c.jpg!w480.jpg" alt=""></p>
<ul>
<li>再次使用top查出对应PID中最耗cpu的子进程（java线程）</li>
</ul>
<p>top -p 1414 -H</p>
<p><img src="http://img2001.static.suishenyun.net/25ece6711a70a7938cb1105810f59bd3/c8a8b0a93c57992b636427f96e6607ee.jpg!w480.jpg" alt=""></p>
<p>找到1462  1482 2个线程。</p>
<ul>
<li>从dump下来的堆栈信息中查找耗费性能的代码块</li>
</ul>
<p>从上面开到，我们用top找出来的pid是十进制的。而dump下来的nid是十六进制的。利用printf命令格式化来转换一下进制（当然，也可以用其他方式）：</p>
<p><img src="http://img2001.static.suishenyun.net/25ece6711a70a7938cb1105810f59bd3/e9199514d71fbe272723db9b1a17c97d.jpg!w480.jpg" alt=""></p>
<p>通过vim查找之前保存的线程堆栈信息，就能找到问题代码所在了。 </p>
<p><img src="http://img2001.static.suishenyun.net/25ece6711a70a7938cb1105810f59bd3/4ab6e1bbe2e147681deec8d615ad2721.jpg!w480.jpg" alt=""></p>
<p>发现是之前的用RabbitMQ来检查业务系统更新的线程有问题， 跟了下代码，这块逻辑之前是国内版用的，海外版有了新的接口，所以直接停掉这个后台任务，部署， cpu降下来了；<br> ​<br><img src="http://img2001.static.suishenyun.net/25ece6711a70a7938cb1105810f59bd3/b60ab6ae60752f709d0c35e7f859787f.jpg!w480.jpg" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-the-teach-stack-of-java-backend-develop" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/06/19/the-teach-stack-of-java-backend-develop/" class="article-date">
  	<time datetime="2015-06-19T13:55:47.000Z" itemprop="datePublished">2015-06-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/19/the-teach-stack-of-java-backend-develop/">Java后端开发技术选型</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Web">Web</h2><ul>
<li><p>MVC Framwork： SpringMVC3.0 Restful的风格终于回归了MVC框架的简单本质，对比之下Struts2概念太复杂更新又太懒了。</p>
</li>
<li><p>Template：JSP2.0且尽量使用JSP EL而不是taglib，万一要写taglib也用纯JSP来编写，一向是SpringSide的推荐，Freemarker们始终有点小众, 而Thymeleaf与美工配合度非常高，可惜也是太少用户了。</p>
</li>
<li><p>Layout Decoration： Tiles的配置都太复杂了，<a href="https://github.com/sitemesh/sitemesh2" target="_blank" rel="external">SiteMesh2</a>好些，但Sitemesh3烂尾了。</p>
</li>
<li><p>Javascript Library： 随大流用了<a href="http://www.jquery.com/" target="_blank" rel="external">JQuery</a>。其实Dojo的面向对象语法更优美，但用户数和插件社区差了点。</p>
</li>
<li><p>CSS Framework： 最热火的<a href="http://twitter.github.com/bootstrap/" target="_blank" rel="external">Twitter Bootstrap</a>，提供了简便的布局能力和基本的页面美化。</p>
</li>
<li><p>JavaScript/CSS Compressor: 还是随便选的<a href="http://developer.yahoo.com/yui/compressor/" target="_blank" rel="external">YUI Compressor</a>。</p>
</li>
<li><p>Validation: <a href="http://jqueryvalidation.org/" target="_blank" rel="external">JQuery Validation Plugin</a>这种客户端校验的客户体验更好，而Spring MVC集成Hibernate Valiator的服务端校验则可以避免恶意用户跳过页面直接发送请求，校验规则也更多，需要混合使用。</p>
</li>
</ul>
<h2 id="WebService">WebService</h2><ul>
<li><p>SOAP WebService： JAX-WS2.0的注解 + <a href="http://cxf.apache.org/" target="_blank" rel="external">Apache CXF</a> 无疑是最成熟的，一说起Axis1/2我都要打冷颤。</p>
</li>
<li><p>Restful Service： JAX-RS 1.0 + Jersey/CXF，够标准。但直接使用Spring MVC能使架构更简单。 如果追求极致的性能标，直接写Servlet也没啥。</p>
</li>
<li><p>Restful Client: 刚出来的JAX-RS 2.0标准，实际是用Jersey的client api做蓝本的， 而直接使用Spring的RestTemplate可以减少第三方包的引入。</p>
</li>
<li><p>为了隔绝变化影响，隐藏细节，对外暴露的DTO和应用内部的领域对象是不同的类型，用<a href="http://dozer.sourceforge.net/" target="_blank" rel="external">Dozer</a>进行复制。</p>
</li>
<li><p>请求参数的校验，JSR303 Bean Validator的实现<a href="http://www.hibernate.org/subprojects/validator.html" target="_blank" rel="external">Hibernate Validator</a>没太多的竞争对手。</p>
</li>
</ul>
<h2 id="Database">Database</h2><ul>
<li><p>ORM Framework： 快速开发的应用里，领域对象肯定是用JPA标注的。至于API用Hibernate还是JPA，因为那个极简便的，DAO只要写接口就好了的<a href="http://www.springsource.org/spring-data/jpa" target="_blank" rel="external">Spring-Data-JPA</a>，所以选了<a href="http://www.hibernate.org/" target="_blank" rel="external">JPA</a>。 当然，JPA的实现还是用Hibernate。</p>
</li>
<li><p>追求高性能的应用，如各种Web服务，当然就是<a href="http://code.google.com/p/mybatis/" target="_blank" rel="external">MyBatis</a>了。如果项目再简单点，Spring JDBC其实也不错。</p>
</li>
<li><p>传统数据库: 无非Oracle与MySQL的选择，如果你恨MySQL依然是Oracle家的东西，可以考虑越来越多人用的，语法和Oracle很像的Postgresql。</p>
</li>
<li><p>NOSQL数据库: 国内用的比较多的还是<a href="http://www.redis.io/" target="_blank" rel="external">Redis</a>和MongoDB。Redis更像一个数据结构服务器，暴露各种数据结构的专有API。而MongoDB将数据存成BSON格式，也提供类似SQL的查询语句，更像一个schema-less的数据库。</p>
</li>
<li><p>数据库连接池: Apache DBCP本来一统江湖，现在被人批评又慢又复杂，所以有了<a href="http://tomcat.apache.org/tomcat-7.0-doc/jdbc-pool.html" target="_blank" rel="external">Tomcat JDBC</a>，另外温少的Druid也是一个选择。</p>
</li>
<li><p>Cache： 在JVM里的缓存，最老牌最多人用的依然是Ehcache，一些更强大的DataGrid方案如HazelCast，JBoss的Infinispan反而没什么人用。另外最简单的JVM内缓存是<a href="https://code.google.com/p/guava-libraries/wiki/CachesExplained" target="_blank" rel="external">Guava</a>的Cache。</p>
</li>
<li><p>而中央式的缓存，Memcached已经成为了事实标准。而且当主创撒手不管后，社区现在反而有着稳定的更新。 Client方面，比较稳健选择的还是Spymemcached。</p>
</li>
</ul>
<h2 id="Services">Services</h2><ul>
<li><p>Security Framework： 选择<a href="http://shiro.apache.org/" target="_blank" rel="external">Apache Shiro</a>是因为SpringSecurity的代码复杂度已经超过了它的实际需要，扩展困难痛苦。另一个原因是SpringSecurity的基本API居然只支持基于角色的判断，e.g. hasRole(“Administrator”)，而Shiro同时还支持我们其实更常用的基于Permission的判断，e.g. hasPermission(“User:Edit”)。</p>
</li>
<li><p>JMS： <a href="http://activemq.apache.org/" target="_blank" rel="external">ActiveMQ</a>是最多人选用的应用服务器无关的JMS实现，JBoss的HornetQ同样只是JBoss的用户在使用。Spring自带的JMS封装很好用。但还有更高级的如支持跨平台的AMQP协议的RabbmitMQ。</p>
</li>
<li><p>Schedule： 对于固定时间间隔的任务，JDK自带的Executor已足够好。Cron式定时执行，Spring的Scheduler也能满足。而且Spring的提供的纯XML配置也让Scheduler变得很简单，<a href="http://quartz-scheduler.org/" target="_blank" rel="external">Quartz</a>更大的优势体现在保证集群中有且仅有一台服务器执行任务。</p>
</li>
<li><p>JMX: <a href="http://www.jolokia.org/" target="_blank" rel="external">Jolokia</a>能将JMX中的MBean以Restful+JSON的方式暴露出来，使JMX这个古老的，在平台互通中显得有点封闭的协议重新焕发了青春。而Spring-Jmx将普通POJO注释一下就变成MBean也非常方便。</p>
</li>
<li><p>其他Production Feature: 用<a href="https://github.com/Netflix/Hystrix" target="_blank" rel="external">Hystrix</a>对访问资源进行并发、延时、短路控制，防止系统雪崩。</p>
</li>
</ul>
<h2 id="Utilizes">Utilizes</h2><ul>
<li><p>General： <a href="http://commons.apache.org/lang/" target="_blank" rel="external">Apache Commons Lang</a>说是伴着我们长大的也不为过，3.0版连package名也改了，全面支持泛型。 Guava 是Google新鲜推出的优雅产品。但说它会一桶天下又不定，因为它有时候太新潮了，反而用不惯。比如StringUtils我还是喜欢用Apache的，IO也同样是Apache Commons IO的好使。</p>
</li>
<li><p>XML： 用JDK自带的JAXB就算了，不折腾。</p>
</li>
<li><p>JSON： GSon虽然系出名门而且接口优雅，但<a href="http://jackson.codehaus.org/" target="_blank" rel="external">Jackson</a>的功能更加丰富到匪夷所思，而且比GSon快很多。</p>
</li>
<li><p>Email： Spring自带的Email封装挺好用的。</p>
</li>
<li><p>Logging: <a href="http://www.slf4j.org/" target="_blank" rel="external">Slf4j</a>作为入口，早就替代了Apache Common Logging了，下面的实现Log4j 1.x 被批判太多同步方法太慢，Log4j作者的后作Logback就好很多了，但社区似乎不甘心log在一家QOS公司手里，又在推动log4j2.0的发展，目前还是beta版。另外选择<a href="http://logstash.net/" target="_blank" rel="external">Logstash</a>做日志的中央式处理。</p>
</li>
<li><p>最后，Freemarker虽然不用来做页面Template，平时用来生成点东西也不错的。JodaTime这种要直接加入JDK的就不多说它了。HttpClient建议用Apache HttpClient好过JDK自带。</p>
</li>
</ul>
<h2 id="Test">Test</h2><ul>
<li><p>Unit Test： JUnit始终是正统，TestNG的功能如测试用例分组它也慢慢支持了。<a href="http://joel-costigliola.github.io/assertj/" target="_blank" rel="external">AssertJ</a> 是目前最好的Assert语句库。</p>
</li>
<li><p>Mock： Mockito的API比老牌的EasyMock更为优雅，而PowerMock则能配合Mockito完成static方法，函数内部new 出来的对象这些Mockito做不了的mock。</p>
</li>
<li><p>Functional Test：Selenium与WebDriver的合并后，最大改进是原来基于javascript的方案， 变成了直接调用浏览器的核心API，性能好了。</p>
</li>
<li><p>Performance/Stability Test: [Jmeter]作为测试工具是最成熟的，Gatling还需要时间成熟。</p>
</li>
</ul>
<h2 id="Development_Environment">Development Environment</h2><ul>
<li><p>JDK6这样没什么兼容性问题又成熟得一塌糊涂的版本建议大家都升级吧。JDK7也不错，有G1垃圾收集器和Try-Catch新语法的语法糖。</p>
</li>
<li><p>用<a href="http://www.eclipse.org/jetty/" target="_blank" rel="external">Jetty7</a>是因为它的嵌入式版本做得好，集成测试不用部署直接就开跑了。开发时一般也不用Eclipse插件，直接自己在代码里启动了，省下打包拷贝War文件的时间。Tomcat现在也有嵌入式版本了，而Jetty最新版要JDK7。</p>
</li>
<li><p>用<a href="http://www.h2database.com/" target="_blank" rel="external">H2 Database</a>，既是嵌入式的，又可以持久化到文件用Web Console查看，性能还是嵌入式中最好的。</p>
</li>
<li><p>用<a href="http://maven.apache.org/" target="_blank" rel="external">Maven</a>，在项目构建脚本不复杂的时候的首选，否则就只能ant+ivy了，或者像hibernate和spring一样，用gradle.</p>
</li>
<li><p>另外，用<a href="http://code.google.com/p/log4jdbc/" target="_blank" rel="external">Log4jdbc</a>在开发时查看实际执行的SQL。</p>
</li>
<li><p>最后，用<a href="http://www.jenkins-ci.org/" target="_blank" rel="external">Jenkins</a>做持续集成, <a href="http://www.sonarsource.org/" target="_blank" rel="external">Sonar</a>做代码质量检查，是大部分好项目的共同爱好。</p>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 fwwdn
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: undefined,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: undefined
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>